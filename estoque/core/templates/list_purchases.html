{% extends 'base.html' %}

{% block content %}
<h1 class="mb-3">Listar Compras</h1>
<div class="row">
  <div class="col-12">
  {% regroup purchases by purchase_date|date:"Y-m" as purchases_by_day %}
  {% for day in purchases_by_day %}

    <div class="card mb-3">
      <div class="card-header bg-info text-white">
          Data: {{ day.grouper }}
      </div>
      <div class="card-block">
        <div class="card-deck">

          {% for purchase in day.list %}
          <div class="card mb-3">
            <div class="card-header">
              <h5 class="card-text">{{ purchase.product }}</h5>
            </div>
            <div class="card-block">
              <p class="card-text">Data da compra: {{ purchase.purchase_date }}</p>
              <p class="card-text">Preço Unitário: R$ {{ purchase.unit_price }}</p>
              <p class="card-text">Quantidade: {{ purchase.quantity }}</p>
              <p class="card-text">Valor Total: R$ {{ purchase.value }}</p>
              <p class="card-text">Preço médio: R$ {{ purchase.product.average_coast }}</p>
            </div>
          </div>
          {% endfor %}

      </div>
      </div>
    </div>

  {% endfor %}
  {% if is_paginated %}
  <div class="pagination">
    <span class="page-links">
      {% if page_obj.has_previous %}
          <a href="?page={{ page_obj.previous_page_number }}">previous</a>
      {% endif %}
      <span class="page-current">
          Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
      </span>
      {% if page_obj.has_next %}
          <a href="?page={{ page_obj.next_page_number }}">next</a>
      {% endif %}
    </span>
  </div>
  {% endif %}

  </div>
</div>
{% endblock content %}